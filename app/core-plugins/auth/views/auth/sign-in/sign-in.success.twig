{% extends "layouts/ajax.twig" %}

{% block content %}

    {% set temporaryUserProfileContainerId = uniqid()  %}

    <!-- temporary HTML container for our user profile display -->
    <div id="user-profile-{{ temporaryUserProfileContainerId }}" class="hidden">
        {% include 'common/user-display' with {'user': user} %}
    </div>

    <script>
        (function ($)
        {
            // The user profile must be displayed in the #logged-user-container
            var $userProfile = $("#user-profile-{{ temporaryUserProfileContainerId }}");
            $('#logged-user-container').html( $userProfile.html() );
            $userProfile.remove();

            // No "signup"/"signin" links in our header
            $("header .signup, header .signin").addClass("hidden");
            // ...but we show the "signout" link
            $("header .signout").removeClass("hidden");

            // Back to intended page or home, please!
            History.pushState(null, null, '{{ session_get('url.intended', '/') }}');
            {% set dummy = session_forget('url.intended') %}

        })(jQuery);
    </script>

{% endblock %}
